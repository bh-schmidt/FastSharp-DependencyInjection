variables:
  Major: '1'
  Minor: '0'
  Patch: '0'

trigger:
- master

pool:
  vmImage: ubuntu-latest

stages:
  - stage: Build
    jobs:
      - job: 'build_project'
        steps:
          - task: DotNetCoreCLI@2
            inputs:
              command: 'build'
              projects: '**/*.csproj'
          - task: DotNetCoreCLI@2
            inputs:
              command: 'pack'
              packagesToPack: '**/*.csproj'
              versioningScheme: byPrereleaseNumber
              majorVersion: '$(Major)'
              minorVersion: '$(Minor)'
              patchVersion: '$(Patch)'
  - stage: Publish
    jobs:
      - job: build_project
        steps:
          - task: DotNetCoreCLI@2
            inputs:
              command: 'push'
              packagesToPush: '$(Pipeline.Workspace)/**/*.nupkg'
              nuGetFeedType: 'external'
              publishFeedCredentials: 'Nuget.Org'